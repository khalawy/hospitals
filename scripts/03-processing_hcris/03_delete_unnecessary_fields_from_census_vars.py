import arcpy, time, datetime, csv, sys, traceback
from arcpy import env
env.overwriteOutput = True

#MacBook Pro-Windows 7
drive_path = "V:/"
#dropbox_path = "W:/"

#008
drive_path = "E:/SpiderOak/"
#dropbox_path = "W:/"

fl = drive_path + "projects/hospitals/"
fld = fl + "data"

print "copy 4 tables, not health insurace, to processing folder and then delete unneccessary fields and rename agesex to agesexrace"
arcpy.Copy_management(fld+"/input/census/variables.gdb/agesexrace",fld+"/processing/variables.gdb/agesexrace","Table")
arcpy.Copy_management(fld+"/input/census/variables.gdb/econ",fld+"/processing/variables.gdb/econ","Table")
arcpy.Copy_management(fld+"/input/census/variables.gdb/education",fld+"/processing/variables.gdb/education","Table")
arcpy.Copy_management(fld+"/input/census/variables.gdb/lingiso",fld+"/processing/variables.gdb/lingiso","Table")
arcpy.Copy_management(fld+"/input/census/variables.gdb/poverty",fld+"/processing/variables.gdb/poverty","Table")

print "delete unnecessary fields"
arcpy.DeleteField_management(fld+"/processing/variables.gdb/agesexrace","GEO_id2;GEO_display_label;HC02_VC01;HC02_VC03;HC02_VC04;HC01_VC05;HC02_VC05;HC01_VC06;HC02_VC06;HC01_VC07;HC02_VC07;HC01_VC08;HC02_VC08;HC01_VC09;HC02_VC09;HC01_VC10;HC02_VC10;HC01_VC11;HC02_VC11;HC01_VC12;HC02_VC12;HC01_VC13;HC02_VC13;HC01_VC14;HC02_VC14;HC01_VC15;HC02_VC15;HC01_VC16;HC02_VC16;HC01_VC17;HC02_VC17;HC02_VC18;HC01_VC19;HC02_VC19;HC01_VC20;HC02_VC20;HC01_VC21;HC02_VC21;HC01_VC22;HC02_VC22;HC01_VC23;HC02_VC23;HC01_VC24;HC02_VC24;HC02_VC25;HC02_VC26;HC02_VC28;HC02_VC29;HC02_VC30;HC02_VC31;HC02_VC32;HC01_VC33;HC02_VC33;HC01_VC34;HC02_VC34;HC01_VC35;HC02_VC35;HC01_VC36;HC02_VC36;HC01_VC37;HC02_VC37;HC01_VC38;HC02_VC38;HC01_VC39;HC02_VC39;HC01_VC40;HC02_VC40;HC01_VC41;HC02_VC41;HC01_VC42;HC02_VC42;HC01_VC43;HC02_VC43;HC01_VC44;HC02_VC44;HC01_VC45;HC02_VC45;HC01_VC46;HC02_VC46;HC01_VC48;HC02_VC48;HC01_VC49;HC02_VC49;HC01_VC50;HC02_VC50;HC01_VC51;HC02_VC51;HC01_VC52;HC02_VC52;HC01_VC53;HC02_VC53;HC02_VC55;HC02_VC56;HC01_VC57;HC02_VC57;HC01_VC58;HC02_VC58;HC01_VC59;HC02_VC59;HC01_VC60;HC02_VC60;HC01_VC61;HC02_VC61;HC01_VC62;HC02_VC62;HC01_VC64;HC02_VC64;HC01_VC65;HC02_VC65;HC01_VC66;HC02_VC66;HC01_VC67;HC02_VC67;HC01_VC68;HC02_VC68;HC01_VC69;HC02_VC69;HC01_VC70;HC02_VC70;HC01_VC71;HC02_VC71;HC01_VC72;HC02_VC72;HC01_VC73;HC02_VC73;HC01_VC74;HC02_VC74;HC01_VC75;HC02_VC75;HC01_VC76;HC02_VC76;HC01_VC78;HC02_VC78;HC01_VC79;HC02_VC79;HC01_VC80;HC02_VC80;HC01_VC81;HC02_VC81;HC01_VC82;HC02_VC82;HC01_VC83;HC02_VC83;HC01_VC84;HC02_VC84;HC01_VC85;HC02_VC85;HC01_VC86;HC02_VC86;HC01_VC87;HC02_VC87;HC01_VC88;HC02_VC88;HC01_VC89;HC02_VC89;HC01_VC90;HC02_VC90;HC01_VC91;HC02_VC91;HC01_VC93;HC02_VC93;HC01_VC94;HC02_VC94;HC01_VC95;HC02_VC95;HC01_VC96;HC02_VC96;HC01_VC97;HC02_VC97;HC01_VC98;HC02_VC98;HC01_VC100;HC02_VC100;HC01_VC101;HC02_VC101;HC01_VC102;HC02_VC102;HC01_VC103;HC02_VC103;HC01_VC104;HC02_VC104")
arcpy.DeleteField_management(fld+"/processing/variables.gdb/econ","GEO_id2;GEO_display_label;HC02_VC02;HC02_VC03;HC01_VC04;HC02_VC04;HC01_VC05;HC02_VC05;HC01_VC06;HC02_VC06;HC01_VC07;HC02_VC07;HC02_VC08;HC02_VC09;HC01_VC10;HC02_VC10;HC01_VC11;HC02_VC11;HC01_VC12;HC02_VC12;HC01_VC13;HC02_VC13;HC01_VC14;HC02_VC14;HC01_VC15;HC02_VC15;HC01_VC17;HC02_VC17;HC01_VC18;HC02_VC18;HC01_VC19;HC02_VC19;HC01_VC20;HC02_VC20;HC01_VC21;HC02_VC21;HC01_VC22;HC02_VC22;HC01_VC23;HC02_VC23;HC01_VC24;HC02_VC24;HC02_VC25;HC01_VC27;HC02_VC27;HC01_VC28;HC02_VC28;HC01_VC29;HC02_VC29;HC01_VC30;HC02_VC30;HC01_VC31;HC02_VC31;HC01_VC32;HC02_VC32;HC01_VC34;HC02_VC34;HC01_VC35;HC02_VC35;HC01_VC36;HC02_VC36;HC01_VC37;HC02_VC37;HC01_VC38;HC02_VC38;HC01_VC39;HC02_VC39;HC01_VC40;HC02_VC40;HC01_VC41;HC02_VC41;HC01_VC42;HC02_VC42;HC01_VC43;HC02_VC43;HC01_VC44;HC02_VC44;HC01_VC45;HC02_VC45;HC01_VC46;HC02_VC46;HC01_VC48;HC02_VC48;HC01_VC49;HC02_VC49;HC01_VC50;HC02_VC50;HC01_VC51;HC02_VC51;HC01_VC53;HC02_VC53;HC01_VC54;HC02_VC54;HC01_VC55;HC02_VC55;HC01_VC56;HC02_VC56;HC01_VC57;HC02_VC57;HC01_VC58;HC02_VC58;HC01_VC59;HC02_VC59;HC01_VC60;HC02_VC60;HC01_VC61;HC02_VC61;HC01_VC62;HC02_VC62;HC01_VC63;HC02_VC63;HC01_VC64;HC02_VC64;HC01_VC65;HC02_VC65;HC01_VC66;HC02_VC66;HC01_VC67;HC02_VC67;HC01_VC68;HC02_VC68;HC01_VC69;HC02_VC69;HC01_VC70;HC02_VC70;HC01_VC71;HC02_VC71;HC01_VC72;HC02_VC72;HC01_VC73;HC02_VC73;HC01_VC74;HC02_VC74;HC01_VC75;HC02_VC75;HC01_VC76;HC02_VC76;HC01_VC77;HC02_VC77;HC01_VC78;HC02_VC78;HC01_VC79;HC02_VC79;HC01_VC80;HC02_VC80;HC01_VC81;HC02_VC81;HC01_VC82;HC02_VC82;HC01_VC83;HC02_VC83;HC01_VC84;HC02_VC84;HC01_VC85;HC02_VC85;HC01_VC86;HC02_VC86;HC01_VC87;HC02_VC87;HC01_VC89;HC02_VC89;HC01_VC90;HC02_VC90;HC02_VC92;HC02_VC93;HC01_VC94;HC02_VC94;HC01_VC95;HC02_VC95;HC01_VC96;HC02_VC96;HC01_VC97;HC02_VC97;HC01_VC98;HC02_VC98;HC01_VC99;HC02_VC99;HC01_VC100;HC02_VC100;HC01_VC101;HC02_VC101;HC01_VC102;HC02_VC102;HC01_VC103;HC02_VC103;HC02_VC104;HC02_VC105;HC01_VC106;HC02_VC106;HC01_VC107;HC02_VC107;HC01_VC108;HC02_VC108;HC01_VC109;HC02_VC109;HC01_VC110;HC02_VC110;HC01_VC111;HC02_VC111;HC01_VC112;HC02_VC112;HC01_VC113;HC02_VC113;HC01_VC114;HC02_VC114;HC01_VC115;HC02_VC115")
arcpy.DeleteField_management(fld+"/processing/variables.gdb/education","GEO_id2;GEO_display_label;HC01_VC02;HC02_VC02;HC01_VC03;HC02_VC03;HC01_VC04;HC02_VC04;HC01_VC05;HC02_VC05;HC01_VC06;HC02_VC06;HC01_VC07;HC02_VC07;HC02_VC09;HC02_VC10;HC02_VC11;HC02_VC12;HC02_VC13;HC02_VC14;HC02_VC15;HC02_VC16;HC02_VC17;HC02_VC18;HC01_VC20;HC02_VC20;HC01_VC21;HC02_VC21;HC01_VC22;HC02_VC22;HC01_VC23;HC02_VC23;HC01_VC24;HC02_VC24;HC01_VC25;HC02_VC25;HC01_VC26;HC02_VC26;HC01_VC27;HC02_VC27;HC01_VC29;HC02_VC29;HC01_VC30;HC02_VC30;HC01_VC32;HC02_VC32;HC01_VC33;HC02_VC33;HC01_VC35;HC02_VC35;HC01_VC36;HC02_VC36;HC01_VC37;HC02_VC37;HC01_VC38;HC02_VC38;HC01_VC39;HC02_VC39;HC01_VC40;HC02_VC40;HC01_VC41;HC02_VC41;HC01_VC42;HC02_VC42;HC01_VC43;HC02_VC43;HC01_VC45;HC02_VC45;HC01_VC46;HC02_VC46;HC01_VC47;HC02_VC47;HC01_VC48;HC02_VC48;HC01_VC49;HC02_VC49;HC01_VC50;HC02_VC50;HC01_VC51;HC02_VC51;HC01_VC52;HC02_VC52;HC01_VC54;HC02_VC54;HC01_VC55;HC02_VC55;HC01_VC56;HC02_VC56;HC01_VC57;HC02_VC57;HC01_VC58;HC02_VC58;HC01_VC59;HC02_VC59;HC01_VC60;HC02_VC60;HC01_VC61;HC02_VC61;HC01_VC62;HC02_VC62;HC01_VC63;HC02_VC63;HC01_VC65;HC02_VC65;HC01_VC66;HC02_VC66;HC01_VC67;HC02_VC67;HC01_VC68;HC02_VC68;HC01_VC69;HC02_VC69;HC01_VC70;HC02_VC70;HC01_VC71;HC02_VC71;HC01_VC73;HC02_VC73;HC01_VC74;HC02_VC74;HC01_VC75;HC02_VC75;HC01_VC76;HC02_VC76;HC01_VC77;HC02_VC77;HC01_VC78;HC02_VC78;HC01_VC79;HC02_VC79;HC01_VC80;HC02_VC80;HC01_VC81;HC02_VC81;HC01_VC82;HC02_VC82;HC01_VC84;HC02_VC84;HC01_VC85;HC02_VC85;HC01_VC86;HC02_VC86;HC01_VC87;HC02_VC87;HC01_VC88;HC02_VC88;HC01_VC89;HC02_VC89;HC01_VC90;HC02_VC90;HC01_VC91;HC02_VC91;HC01_VC92;HC02_VC92;HC01_VC93;HC02_VC93;HC01_VC94;HC02_VC94;HC01_VC95;HC02_VC95;HC01_VC96;HC02_VC96;HC01_VC97;HC02_VC97;HC01_VC98;HC02_VC98;HC01_VC99;HC02_VC99;HC01_VC100;HC02_VC100;HC01_VC101;HC02_VC101;HC01_VC102;HC02_VC102;HC01_VC103;HC02_VC103;HC01_VC104;HC02_VC104;HC01_VC105;HC02_VC105;HC01_VC106;HC02_VC106;HC01_VC107;HC02_VC107;HC01_VC108;HC02_VC108;HC01_VC109;HC02_VC109;HC01_VC110;HC02_VC110;HC01_VC111;HC02_VC111;HC01_VC112;HC02_VC112;HC01_VC113;HC02_VC113")
arcpy.DeleteField_management(fld+"/processing/variables.gdb/lingiso","GEO_id2;GEO_display_label")
arcpy.DeleteField_management(fld+"/processing/variables.gdb/poverty","GEO_id2;GEO_display_label")

tables_list = ["/processing/variables.gdb/agesexrace",
	"/processing/variables.gdb/econ",
	"/processing/variables.gdb/education",
	"/processing/variables.gdb/lingiso",
	"/processing/variables.gdb/poverty"
	]

for tables in tables_list:
	arcpy.AddField_management(fld+tables, "geoid", "TEXT")

for tables in tables_list:
	arcpy.CalculateField_management(fld+tables, "geoid", "!GEO_id![9:]", "PYTHON_9.3")

for tables in tables_list:
	arcpy.DeleteField_management(fld+tables, "GEO_id")

for tables in tables_list:
	arcpy.AddField_management(fld+tables, "county", "TEXT")

for tables in tables_list:
	arcpy.CalculateField_management(fld+tables, "county", "!geoid![:5]", "PYTHON_9.3")

print "frequency to get the county census stats"
arcpy.Frequency_analysis(fld+"/processing/variables.gdb/agesexrace",fld+"/processing/variables.gdb/agesexrace_county","county","HC01_VC01;HC01_VC03;HC01_VC04;HC01_VC18;HC01_VC25;HC01_VC26;HC01_VC28;HC01_VC29;HC01_VC30;HC01_VC31;HC01_VC32;HC01_VC55;HC01_VC56")
arcpy.Frequency_analysis(fld+"/processing/variables.gdb/econ",fld+"/processing/variables.gdb/econ_county","county","HC01_VC02;HC01_VC03;HC01_VC08;HC01_VC09;HC01_VC25;HC01_VC92;HC01_VC104")
arcpy.Frequency_analysis(fld+"/processing/variables.gdb/education",fld+"/processing/variables.gdb/education_county","county","HC01_VC09;HC01_VC10;HC01_VC11;HC01_VC12;HC01_VC13;HC01_VC14;HC01_VC15;HC01_VC16;HC01_VC17;HC01_VC18")
arcpy.Frequency_analysis(fld+"/processing/variables.gdb/lingiso",fld+"/processing/variables.gdb/lingiso_county","county","VD01;VD02;VD03;VD04;VD05;VD06;VD07;VD08;VD09;VD10;VD11;VD12;VD13;VD14")
arcpy.Frequency_analysis(fld+"/processing/variables.gdb/poverty",fld+"/processing/variables.gdb/poverty_county","county","HC02_VC01;HC03_VC01")

